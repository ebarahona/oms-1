(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.oms = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
!function(e){"use strict";function t(){}function n(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1}function r(e){return function(){return this[e].apply(this,arguments)}}function i(e){return"function"==typeof e||e instanceof RegExp||!(!e||"object"!=typeof e)&&i(e.listener)}var s=t.prototype,o=e.EventEmitter;s.getListeners=function(e){var t,n,r=this._getEvents();if(e instanceof RegExp){t={};for(n in r)r.hasOwnProperty(n)&&e.test(n)&&(t[n]=r[n])}else t=r[e]||(r[e]=[]);return t},s.flattenListeners=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n.push(e[t].listener);return n},s.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&(t={},t[e]=n),t||n},s.addListener=function(e,t){if(!i(t))throw new TypeError("listener must be a function");var r,s=this.getListenersAsObject(e),o="object"==typeof t;for(r in s)s.hasOwnProperty(r)&&n(s[r],t)===-1&&s[r].push(o?t:{listener:t,once:!1});return this},s.on=r("addListener"),s.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},s.once=r("addOnceListener"),s.defineEvent=function(e){return this.getListeners(e),this},s.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},s.removeListener=function(e,t){var r,i,s=this.getListenersAsObject(e);for(i in s)s.hasOwnProperty(i)&&(r=n(s[i],t),r!==-1&&s[i].splice(r,1));return this},s.off=r("removeListener"),s.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},s.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},s.manipulateListeners=function(e,t,n){var r,i,s=e?this.removeListener:this.addListener,o=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(r=n.length;r--;)s.call(this,t,n[r]);else for(r in t)t.hasOwnProperty(r)&&(i=t[r])&&("function"==typeof i?s.call(this,r,i):o.call(this,r,i));return this},s.removeEvent=function(e){var t,n=typeof e,r=this._getEvents();if("string"===n)delete r[e];else if(e instanceof RegExp)for(t in r)r.hasOwnProperty(t)&&e.test(t)&&delete r[t];else delete this._events;return this},s.removeAllListeners=r("removeEvent"),s.emitEvent=function(e,t){var n,r,i,s,o,u=this.getListenersAsObject(e);for(s in u)if(u.hasOwnProperty(s))for(n=u[s].slice(0),i=0;i<n.length;i++)r=n[i],r.once===!0&&this.removeListener(e,r.listener),o=r.listener.apply(this,t||[]),o===this._getOnceReturnValue()&&this.removeListener(e,r.listener);return this},s.trigger=r("emitEvent"),s.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},s.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},s._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},s._getEvents=function(){return this._events||(this._events={})},t.noConflict=function(){return e.EventEmitter=o,t},"function"==typeof define&&define.amd?define(function(){return t}):"object"==typeof module&&module.exports?module.exports=t:e.EventEmitter=t}(this||{});
},{}],2:[function(require,module,exports){
function Oms(t){this._collection=t,this._maxOpId=0,this._replicateCollectionFunctions()}var EventEmitter=require("wolfy87-eventemitter"),Utils=require("./Utils");Oms.prototype.__proto__=EventEmitter.prototype,Oms.prototype._replicateCollectionFunctions=function(){var t=this,o=Utils.objectPublicFunctions(this._collection),e=["isCapped"];o.forEach(function(o){"undefined"==typeof t[o]&&e.indexOf(o)<0&&(t[o]=function(){t._collectionFunction(o,Array.prototype.slice.call(arguments))})})},Oms.prototype._collectionFunction=function(t,o){function e(){c._collection[t].apply(this._collection,o.concat([n]))}function n(){c._emitQueue.apply(c,[t].concat(r).concat(Array.prototype.slice.call(arguments)).concat([i]))}function i(){if("function"==typeof l){var t=Array.prototype.slice.call(arguments);t.shift(),l.apply(c,t)}}var c=this,r=c._maxOpId;if(c._maxOpId++,Array.isArray(o)&&o.length>0&&"function"==typeof o[o.length-1])var l=o.pop();this._emitQueue.apply(this,["pre-"+t].concat(r).concat(o).concat([e]))},Oms.prototype._emitQueue=function(){var t=this,o=Array.prototype.slice.call(arguments),e=o.shift(),n=o.pop(),i=t.getListeners(e),c=[];i.forEach(function(t){c.push(t.listener)}),Utils.callbackQueue(c,o,function(){i.filter(function(t){return t.once}).forEach(function(o){t.off(e,o.listener)}),"function"==typeof n&&n.apply(t,Array.prototype.slice.call(arguments))})},module.exports=function(t){return new Oms(t)};
},{"./Utils":3,"wolfy87-eventemitter":1}],3:[function(require,module,exports){
var Utils={};Utils.objectPublicFunctions=function(e){function t(e){var t=[];for(var n in e)"function"==typeof e[n]&&t.push(n);return t}return t(e).filter(function(e){return"_"!==e[0]&&"globalFunctions"!==e})},Utils.objectForEach=function(e,t){var n;for(n in e)e.hasOwnProperty(n)&&t(e[n],n,e)},Utils.objectFilterProperties=function(e,t){var n={};return t.forEach(function(t){n[t]=e[t]}),n},Utils.objectContainsObject=function(e,t){for(var n in t)if(t.hasOwnProperty(n)&&(!e.hasOwnProperty(n)||e[n]!=t[n]))return!1;return!0},Utils.objectFilter=function(e,t){var n={};return this.objectForEach(e,function(e,r,i){t(e,r,i)&&(n[r]=e)}),n},Utils.objectGet=function(e,t){var n=this;if(0==t.length)return e;if("object"==typeof e){if(("string"==typeof t[0]||"number"==typeof t[0])&&null!==e&&e.hasOwnProperty(t[0]))return this.objectGet(e[t[0]],t.slice(1));if(null===t[0]){if(Array.isArray(e)){var r=[];e.forEach(function(e,i){r[i]=n.objectGet(e,t.slice(1))})}else{var r={};this.objectForEach(e,function(e,i){r[i]=n.objectGet(e,t.slice(1))})}return r}if(t[0]instanceof RegExp){var r={};return this.objectForEach(e,function(e,i){i.match(t[0])&&(r[i]=n.objectGet(e,t.slice(1)))}),r}if("function"==typeof t[0]){if(e instanceof Array){var r=[];e.forEach(function(e,i,o){t[0](e,i,o)&&(r[i]=n.objectGet(e,t.slice(1)))})}else{var r={};this.objectForEach(n.objectFilter(e,t[0]),function(e,i){r[i]=n.objectGet(e,t.slice(1))})}return r}if(t[0]instanceof Array){if(e instanceof Array){var r=[];t[0].forEach(function(t,n){r[n]=e[n]})}else{var r={};this.objectForEach(n.objectFilterProperties(e,t[0]),function(e,i){r[i]=n.objectGet(e,t.slice(1))})}return r}}},Utils.objectSet=function(e,t,n){return 1==t.length?(e[t[0]]=n,!0):("undefined"==typeof e[t[0]]&&(e[t[0]]={}),this._objectSet(e[t[0]],t.slice(1),n))},Utils.objectIsset=function(e,t){return 1==t.length?"undefined"!=typeof e[t[0]]:"undefined"!=typeof e[t[0]]&&this.objectIsset(e[t[0]],t.slice(1))},Utils.objectMerge=function(){var e={};return this.objectForEach(arguments,function(t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}),e},Utils.parseArgs=function(e,t){function n(e,t){return"function"!=typeof e.validate||e.validate(t)}function r(e,t){for(var n=t;n<e.length;n++)if("undefined"==typeof e[n]||!e[n].required)return!0;return!1}var i={},o=0;return Array.isArray(e)||(e=Array.prototype.slice.call(e)),e.forEach(function(e,c){for(var u=o;u<t.length;u++){if(t[u].required){if(n(t[u],e)){t[u].matched=!0,i[t[u].name]=e,o++;break}throw"missing_required"}if(!t[u].required&&(r(t,u)||t[u].level>t[u-1].level&&t[u-1].matched)&&n(t[u],e)){t[u].matched=!0,i[t[u].name]=e,o++;break}t[u].matched=!1,o++}}),t.forEach(function(e){"undefined"==typeof i[e.name]&&"undefined"!=typeof e.default&&(i[e.name]=e.default)}),i},Utils.callbackQueue=function(){function e(){n++,"function"==typeof t.queueFunctions[n]?Array.isArray(t.queueFunctionArgs)&&!t.options.expand?t.queueFunctions[n](t.queueFunctionArgs,e):Array.isArray(t.queueFunctionArgs)&&t.options.expand?t.queueFunctions[n].apply(this,t.queueFunctionArgs.concat([e])):t.queueFunctions[n](e):"function"==typeof t.queueNoMatchCallback&&t.queueNoMatchCallback.apply(this,t.queueFunctionArgs)}var t=Utils.parseArgs(arguments,[{name:"queueFunctions",level:0,validate:function(e,t){return Array.isArray(e)}},{name:"queueFunctionArgs",level:1,validate:function(e,t){return Array.isArray(e)}},{name:"queueNoMatchCallback",level:1,validate:function(e,t){return"function"==typeof e}},{name:"options",level:1,validate:function(e,t){return"object"==typeof e},default:{}}]);t.options=Utils.objectMerge({expand:!0},t.options);var n=-1;e()},module.exports=Utils;
},{}]},{},[2])(2)
});


//# sourceMappingURL=oms.js.map